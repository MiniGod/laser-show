<html><body style="margin:0">
<canvas id="canvas" width="1920" height="1080"></canvas>
<script>
const canvas = document.getElementById('canvas')
const ctx = canvas.getContext('2d')

// random integer (max is exclusive)
function random(max, min = 0) {
  if (min > max) {
    min ^= max
    max ^= min
    min ^= max
  }

  const diff = max - min

  return min + Math.floor(Math.random() * diff);
}

const randomX = () => random(canvas.width)
const randomY = () => random(canvas.height)
const randomFlip = () => ((random(2) + 1) * 2) - 3

const spots = []
const speeds = []

for (let i = 0; i<100; i++) {
  spots.push([randomX(), randomY()]);

  const speed = random(500, 1000)
  const direction = Math.random() * Math.PI * 2
  speeds.push([
    speed * Math.sin(direction),
    speed * Math.cos(direction)
  ])
}

function reset() {
  ctx.save()
  ctx.fillStyle = "rgba(0,0,0,0.3)"
  ctx.fillRect(0, 0, canvas.width, canvas.height)
  ctx.restore()
}

function moveAll(d) {
  const w = canvas.width
  const h = canvas.height

  for (let i in spots) {
    spots[i][0] += speeds[i][0] * d
    spots[i][1] += speeds[i][1] * d

    if (spots[i][0] > w) { speeds[i][0] *= -1; spots[i][0] = w - (spots[i][0] - w) }
    if (spots[i][1] > h) { speeds[i][1] *= -1; spots[i][1] = h - (spots[i][1] - h) }
    if (spots[i][0] < 0) { speeds[i][0] *= -1; spots[i][0] *= -1 }
    if (spots[i][1] < 0) { speeds[i][1] *= -1; spots[i][1] *= -1 }
  }
}

let t = Date.now();
function preRender() {
  const d = (Date.now() - t) / 1000
  t = Date.now()

  render(d);

  window.requestAnimationFrame(preRender)
}

function render(d) {
  reset()
  moveAll(d)

  ctx.fillStyle = 'white'
  for (let spot of spots) {
    ctx.fillRect(...spot, 5, 5)
  }
}

preRender();
</script>
</body>
</html>
